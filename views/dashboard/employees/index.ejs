<%- include('../../partials/header.ejs', { title: title }) %>

  <div class="page-content">
    <!-- Main sidebar -->
    <%- include('../../partials/sidebar.ejs') %>
      <!-- /main sidebar -->

      <!-- Main content -->
      <div class="content-wrapper">
        <!-- Main navbar -->
        <%- include('../../component/dashboard/navbar.ejs') %>
          <!-- /main navbar -->

          <!-- Inner content -->
          <div class="content-inner">
            <!-- Content area -->
            <div class="content">
              <!-- Nested object data -->
              <div class="card">
                <div class="card-header">
                  <div class="d-flex justify-content-between align-items-center">
                    <h5 class="mb-0">All Employee</h5>
                    <!-- <button class="btn btn-light">Add Customer</button> -->
                   
                    <!-- Button to trigger add employees modal -->
                    <button type="button" class="btn btn-light" data-bs-toggle="modal"
                      data-bs-target="#add-employee-model">
                      Add Employee<i class="ph ph-user ms-2"></i>
                    </button>
                  </div>
                </div>

                <!-- Hidden element to pass JSON data to the JavaScript file -->
                <script type="application/json" id="data">
            <%- JSON.stringify({ data: data, label: "employees" }) %>
          </script>

                <table class="table datatable-nested">
                  <thead>
                    <tr>
                      <th>Name</th>
                      <th>Designation</th>
                      <th>Phone</th>
                      <th>Email</th>
                      <th>Gender</th>
                      <th>DOB</th>
                      <th>Blood Group</th>
                      <th>Address</th>
                      <th>Father</th>
                      <th>Mother</th>
                      <th>Bank</th>
                      <th>Bank Account</th>
                      <th>IFSC Code</th>
                      <th>Aadhaar</th>
                      <th>Pan</th>
                      <th>Joining Date</th>
                      <th>Leaving Date</th>
                      <th>Refer By</th>
                      <th>Reference Phone</th>
                      <th>Action</th>
                    </tr>
                  </thead>
                  <tbody>
                    <!-- Data will be dynamically injected here -->
                  </tbody>
                </table>
              </div>
              <!-- /nested object data -->
            </div>
            <!-- /content area -->
          </div>
          <!-- /inner content -->
      </div>
      <!-- /main content -->
  </div>
  <!-- /page content -->



  <!-- add employee model -->
  <div id="add-employee-model" class="modal fade" tabindex="-1" style="display: none" aria-hidden="true">
    <div class="modal-dialog modal-full">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">Add New Employee</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
        </div>
        <div class="modal-body">
          <form action="/dashboard/employees/create" method="POST" enctype="multipart/form-data">
            <!-- Employee Information -->
            <div class="form-section mb-4">
              <h4 class="mb-3">Employee Information</h4>
              <div class="row">
                <!-- Employee Name -->
                <div class="col-md-6">
                  <div class="mb-3">
                    <label for="employee-name" class="form-label">Employee Name*</label>
                    <input type="text" class="form-control" id="employee-name" name="employee_name" minlength="2"
                      maxlength="8" required pattern="[A-Za-z\s'-]+" required>
                    <small class="form-text text-muted">Enter the full name as per official documents.</small>

                  </div>
                </div>
                <!-- Date of Birth -->
                <div class="col-md-6">
                  <div class="mb-3">
                    <label for="dob" class="form-label">Date of Birth*</label>
                    <input type="date" class="form-control" id="dob" name="dob">
                    <small class="form-text text-muted">Select the date of birth from the calendar.</small>
                  </div>
                </div>
              </div>

              <div class="row">
                <!-- Date of Joining -->
                <div class="col-md-6">
                  <div class="mb-3">
                    <label for="doj" class="form-label">Date of Joining*</label>
                    <input type="date" class="form-control" id="doj" name="doj">
                    <small class="form-text text-muted">Date when the employee joined the company.</small>
                  </div>
                </div>
                <!-- Designation -->
                <div class="col-md-6">
                  <div class="mb-3">
                    <label for="designation" class="form-label">Designation*</label>
                    <input type="text" class="form-control" id="designation" name="designation">
                    <small class="form-text text-muted">Enter the employee's current job title.</small>
                  </div>
                </div>
              </div>

              <div class="row">
                <!-- Gender -->
                <div class="col-md-6">
                  <div class="mb-3">
                    <label for="gender" class="form-label">Gender*</label>
                    <select class="form-control" id="gender" name="gender">
                      <option value="" disabled selected>Select your gender</option>
                      <option value="male">Male</option>
                      <option value="female">Female</option>
                      <option value="non-binary">Non-binary</option>
                      <option value="prefer-not-to-say">Prefer not to say</option>
                      <option value="other">Other</option>
                    </select>
                    <small class="form-text text-muted">Specify the gender as per official records.</small>
                  </div>

                </div>
                <!-- Email -->
                <div class="col-md-6">
                  <div class="mb-3">
                    <label for="email" class="form-label">Email*</label>
                    <input type="email" class="form-control" id="email" name="email" required>
                    <small class="form-text text-muted">Enter a valid email address for communication.</small>
                  </div>
                </div>
              </div>

              <div class="row">
                <!-- Primary Mobile Number -->
                <div class="col-md-6">
                  <div class="mb-3">
                    <label for="primary-mobile" class="form-label">Primary Mobile Number*</label>
                    <input type="tel" class="form-control" id="primary-mobile" name="primary_mobile">
                    <small class="form-text text-muted">Provide a contact number that is frequently used.</small>
                  </div>
                </div>
                <!-- Aadhar Number -->
                <div class="col-md-6">
                  <div class="mb-3">
                    <label for="aadhar-number" class="form-label">Aadhar Number*</label>
                    <input type="text" class="form-control" id="aadhar-number" name="aadhar_number">
                    <small class="form-text text-muted">Enter the 12-digit Aadhar number issued by the Indian
                      government.</small>
                  </div>
                </div>
              </div>

              <div class="row">
                <!-- PAN Number -->
                <div class="col-md-6">
                  <div class="mb-3">
                    <label for="pan-number" class="form-label">PAN Number*</label>
                    <input type="text" class="form-control" id="pan-number" name="pan_number">
                    <small class="form-text text-muted">Provide the Permanent Account Number for tax purposes.</small>
                  </div>
                </div>
                <!-- Address -->
                <div class="col-md-6">
                  <div class="mb-3">
                    <label for="address" class="form-label">Address*</label>
                    <input type="text" class="form-control" id="address" name="address">
                    <small class="form-text text-muted">Enter the current residential address.</small>
                  </div>
                </div>
              </div>

              <div class="row">
                <!-- Bank Account Number -->
                <div class="col-md-6">
                  <div class="mb-3">
                    <label for="bank-account" class="form-label">Bank Account Number*</label>
                    <input type="text" class="form-control" id="bank-account" name="bank_account">
                    <small class="form-text text-muted">Bank account number where salary is credited.</small>
                  </div>
                </div>
                <!-- Bank Name -->
                <div class="col-md-6">
                  <div class="mb-3">
                    <label for="bank-name" class="form-label">Bank Name*</label>
                    <input type="text" class="form-control" id="bank-name" name="bank_name">
                    <small class="form-text text-muted">Name of the bank where the account is held.</small>
                  </div>
                </div>
              </div>

              <div class="row">
                <!-- IFSC Code -->
                <div class="col-md-6">
                  <div class="mb-3">
                    <label for="ifsc-code" class="form-label">IFSC Code*</label>
                    <input type="text" class="form-control" id="ifsc-code" name="ifsc_code">
                    <small class="form-text text-muted">Indian Financial System Code for electronic fund
                      transfers.</small>
                  </div>
                </div>
                <!-- Date of Leaving -->
                <div class="col-md-6">
                  <div class="mb-3">
                    <label for="date-of-leaving" class="form-label">Date of Leaving</label>
                    <input type="date" class="form-control" id="date-of-leaving" name="dol" placeholder="Optional">
                    <small class="form-text text-muted">Date on which the employee leaves the company (if
                      applicable).</small>
                  </div>
                </div>
              </div>

              <div class="row">
                <!-- Photo -->
                <div class="col-md-6">
                  <div class="mb-3">
                    <label for="photo" class="form-label">Photo</label>
                    <input type="file" class="form-control" id="photo" name="photo">
                    <small class="form-text text-muted">Upload employee photo here (if available).</small>
                  </div>
                </div>
                <!-- Father's Name -->
                <div class="col-md-6">
                  <div class="mb-3">
                    <label for="father-name" class="form-label">Father's Name</label>
                    <input type="text" class="form-control" id="father-name" name="father_name" placeholder="Optional">
                    <small class="form-text text-muted">Name of the employee's father.</small>
                  </div>
                </div>
              </div>

              <div class="row">
                <!-- Mother's Name -->
                <div class="col-md-6">
                  <div class="mb-3">
                    <label for="mother-name" class="form-label">Mother's Name</label>
                    <input type="text" class="form-control" id="mother-name" name="mother_name" placeholder="Optional">
                    <small class="form-text text-muted">Name of the employee's mother.</small>
                  </div>
                </div>
                <!-- Spouse's Name -->
                <div class="col-md-6">
                  <div class="mb-3">
                    <label for="spouse-name" class="form-label">Spouse's Name</label>
                    <input type="text" class="form-control" id="spouse-name" name="spouse_name" placeholder="Optional">
                    <small class="form-text text-muted">Name of the employee's spouse (if applicable).</small>
                  </div>
                </div>
              </div>

              <div class="row">
                <!-- Reference -->
                <div class="col-md-6">
                  <div class="mb-3">
                    <label for="reference" class="form-label">Reference</label>
                    <input type="text" class="form-control" id="reference" name="reference" placeholder="Optional">
                    <small class="form-text text-muted">Reference person or entity (if applicable).</small>
                  </div>
                </div>
                <!-- Reference Contact Number -->
                <div class="col-md-6">
                  <div class="mb-3">
                    <label for="reference-contact" class="form-label">Reference Contact Number</label>
                    <input type="tel" class="form-control" id="reference-contact" name="reference_contact"
                      placeholder="Optional">
                    <small class="form-text text-muted">Contact number for the reference provided.</small>
                  </div>
                </div>
              </div>

              <div class="row">
                <!-- Father's Mobile Number -->
                <div class="col-md-6">
                  <div class="mb-3">
                    <label for="father-mobile" class="form-label">Father's Mobile Number</label>
                    <input type="tel" class="form-control" id="father-mobile" name="father_mobile"
                      placeholder="Optional">
                    <small class="form-text text-muted">Mobile number of the employee's father.</small>
                  </div>
                </div>
                <!-- Mother's Mobile Number -->
                <div class="col-md-6">
                  <div class="mb-3">
                    <label for="mother-mobile" class="form-label">Mother's Mobile Number</label>
                    <input type="tel" class="form-control" id="mother-mobile" name="mother_mobile"
                      placeholder="Optional">
                    <small class="form-text text-muted">Mobile number of the employee's mother.</small>
                  </div>
                </div>
              </div>

              <div class="row">
                <!-- Spouse's Mobile Number -->
                <div class="col-md-6">
                  <div class="mb-3">
                    <label for="spouse-mobile" class="form-label">Spouse's Mobile Number</label>
                    <input type="tel" class="form-control" id="spouse-mobile" name="spouse_mobile"
                      placeholder="Optional">
                    <small class="form-text text-muted">Mobile number of the employee's spouse.</small>
                  </div>
                </div>
                <!-- Blood Group -->
                <div class="col-md-6">
                  <div class="mb-3">
                    <label for="blood-group" class="form-label">Blood Group*</label>
                    <select class="form-control" id="blood-group" name="blood_group">
                      <option value="" disabled selected>Select blood group</option>
                      <option value="A+">A+</option>
                      <option value="A-">A-</option>
                      <option value="B+">B+</option>
                      <option value="B-">B-</option>
                      <option value="AB+">AB+</option>
                      <option value="AB-">AB-</option>
                      <option value="O+">O+</option>
                      <option value="O-">O-</option>
                    </select>
                    <small class="form-text text-muted">Select the employee's blood group.</small>
                  </div>
                </div>
              </div>

              <div class="row">
                <!-- Role -->
                <div class="col-md-6">
                  <div class="mb-3">
                    <label for="role" class="form-label">Role*</label>
                    <select class="form-control" id="role" name="role">
                      <option value="" disabled selected>Select role</option>
                      <option value="admin">Admin</option>
                      <option value="moderator">Moderator</option>
                      <option value="user">User</option>
                    </select>
                    <small class="form-text text-muted">Select the employee's role within the system.</small>
                  </div>
                </div>
              </div>

              <div class="row">
                <!-- Comments -->
                <div class="col-md-12">
                  <div class="mb-3">
                    <label for="comments" class="form-label">Comments</label>
                    <textarea class="form-control" id="comments" name="comments" rows="3"
                      placeholder="Optional"></textarea>
                    <small class="form-text text-muted">Add any additional comments or information here.</small>
                  </div>
                </div>
              </div>
            </div>

            <div class="modal-footer">
              <button type="button" class="btn btn-link" data-bs-dismiss="modal">Close</button>
              <button type="submit" class="btn btn-primary">Save</button>
            </div>
          </form>


        </div>
      </div>
    </div>
  </div>


  <!-- Edit employee modal -->
  <div id="edit-employee-model" class="modal fade" tabindex="-1" aria-labelledby="editEmployeeModalLabel"
    aria-hidden="true">m
    <div class="modal-dialog modal-full">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="editEmployeeModalLabel">Edit Employee</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <form action="" method="POST" enctype="multipart/form-data">
            <div class="form-section mb-4">
              <h4 class="mb-3">Employee Information</h4>
              <div class="row">
                <!-- Employee Name -->
                <div class="col-md-6">
                  <div class="mb-3">
                    <label for="employee-name" class="form-label">Employee Name*</label>
                    <input type="text" class="form-control" id="employee-name" name="employee_name" minlength="4"
                      maxlength="20" required>
                    <small class="form-text text-muted">Enter the full name as per official documents.</small>
                  </div>
                </div>
                <!-- Date of Birth -->
                <div class="col-md-6">
                  <div class="mb-3">
                    <label for="dob" class="form-label">Date of Birth*</label>
                    <input type="date" class="form-control" id="dob" name="dob">
                    <small class="form-text text-muted">Select the date of birth from the calendar.</small>
                  </div>
                </div>
              </div>

              <div class="row">
                <!-- Date of Joining -->
                <div class="col-md-6">
                  <div class="mb-3">
                    <label for="doj" class="form-label">Date of Joining*</label>
                    <input type="date" class="form-control" id="doj" name="doj">
                    <small class="form-text text-muted">Date when the employee joined the company.</small>
                  </div>
                </div>
                <!-- Designation -->
                <div class="col-md-6">
                  <div class="mb-3">
                    <label for="designation" class="form-label">Designation*</label>
                    <input type="text" class="form-control" id="designation" name="designation">
                    <small class="form-text text-muted">Enter the employee's current job title.</small>
                  </div>
                </div>
              </div>

              <div class="row">
                <!-- Gender -->
                <div class="col-md-6">
                  <div class="mb-3">
                    <label for="gender" class="form-label">Gender*</label>
                    <select class="form-control" id="gender" name="gender">
                      <option value="" disabled selected>Select your gender</option>
                      <option value="male">Male</option>
                      <option value="female">Female</option>
                      <option value="non-binary">Non-binary</option>
                      <option value="prefer-not-to-say">Prefer not to say</option>
                      <option value="other">Other</option>
                    </select>
                    <small class="form-text text-muted">Specify the gender as per official records.</small>
                  </div>
                </div>
                <!-- Email -->
                <div class="col-md-6">
                  <div class="mb-3">
                    <label for="email" class="form-label">Email*</label>
                    <input type="email" class="form-control" id="email" name="email" required>
                    <small class="form-text text-muted">Enter a valid email address for communication.</small>
                  </div>
                </div>
              </div>

              <div class="row">
                <!-- Primary Mobile Number -->
                <div class="col-md-6">
                  <div class="mb-3">
                    <label for="primary-mobile" class="form-label">Primary Mobile Number*</label>
                    <input type="tel" class="form-control" id="primary-mobile" name="primary_mobile">
                    <small class="form-text text-muted">Provide a contact number that is frequently used.</small>
                  </div>
                </div>
                <!-- Aadhar Number -->
                <div class="col-md-6">
                  <div class="mb-3">
                    <label for="aadhar-number" class="form-label">Aadhar Number*</label>
                    <input type="text" class="form-control" id="aadhar-number" name="aadhar_number">
                    <small class="form-text text-muted">Enter the 12-digit Aadhar number issued by the Indian
                      government.</small>
                  </div>
                </div>
              </div>

              <div class="row">
                <!-- PAN Number -->
                <div class="col-md-6">
                  <div class="mb-3">
                    <label for="pan-number" class="form-label">PAN Number*</label>
                    <input type="text" class="form-control" id="pan-number" name="pan_number">
                    <small class="form-text text-muted">Provide the Permanent Account Number for tax purposes.</small>
                  </div>
                </div>
                <!-- Address -->
                <div class="col-md-6">
                  <div class="mb-3">
                    <label for="address" class="form-label">Address*</label>
                    <input type="text" class="form-control" id="address" name="address">
                    <small class="form-text text-muted">Enter the current residential address.</small>
                  </div>
                </div>
              </div>

              <div class="row">
                <!-- Bank Account Number -->
                <div class="col-md-6">
                  <div class="mb-3">
                    <label for="bank-account" class="form-label">Bank Account Number*</label>
                    <input type="text" class="form-control" id="bank-account" name="bank_account">
                    <small class="form-text text-muted">Bank account number where salary is credited.</small>
                  </div>
                </div>
                <!-- Bank Name -->
                <div class="col-md-6">
                  <div class="mb-3">
                    <label for="bank-name" class="form-label">Bank Name*</label>
                    <input type="text" class="form-control" id="bank-name" name="bank_name">
                    <small class="form-text text-muted">Name of the bank where the account is held.</small>
                  </div>
                </div>
              </div>

              <div class="row">
                <!-- IFSC Code -->
                <div class="col-md-6">
                  <div class="mb-3">
                    <label for="ifsc-code" class="form-label">IFSC Code*</label>
                    <input type="text" class="form-control" id="ifsc-code" name="ifsc_code">
                    <small class="form-text text-muted">Indian Financial System Code for electronic fund
                      transfers.</small>
                  </div>
                </div>
                <!-- Date of Leaving -->
                <div class="col-md-6">
                  <div class="mb-3">
                    <label for="date-of-leaving" class="form-label">Date of Leaving</label>
                    <input type="date" class="form-control" id="date-of-leaving" name="dol" placeholder="Optional">
                    <small class="form-text text-muted">Date on which the employee leaves the company (if
                      applicable).</small>
                  </div>
                </div>
              </div>

              <div class="row">
                <!-- Photo -->
                <div class="col-md-6">
                  <div class="mb-3">
                    <label for="photo" class="form-label">Photo</label>
                    <input type="file" class="form-control" id="photo" name="photo">
                    <small class="form-text text-muted">Upload employee photo here (if available).</small>
                  </div>
                </div>
                <!-- Father's Name -->
                <div class="col-md-6">
                  <div class="mb-3">
                    <label for="father-name" class="form-label">Father's Name</label>
                    <input type="text" class="form-control" id="father-name" name="father_name" placeholder="Optional">
                    <small class="form-text text-muted">Name of the employee's father.</small>
                  </div>
                </div>
              </div>

              <div class="row">
                <!-- Mother's Name -->
                <div class="col-md-6">
                  <div class="mb-3">
                    <label for="mother-name" class="form-label">Mother's Name</label>
                    <input type="text" class="form-control" id="mother-name" name="mother_name" placeholder="Optional">
                    <small class="form-text text-muted">Name of the employee's mother.</small>
                  </div>
                </div>
                <!-- Spouse's Name -->
                <div class="col-md-6">
                  <div class="mb-3">
                    <label for="spouse-name" class="form-label">Spouse's Name</label>
                    <input type="text" class="form-control" id="spouse-name" name="spouse_name" placeholder="Optional">
                    <small class="form-text text-muted">Name of the employee's spouse (if applicable).</small>
                  </div>
                </div>
              </div>

              <div class="row">
                <!-- Reference -->
                <div class="col-md-6">
                  <div class="mb-3">
                    <label for="reference" class="form-label">Reference</label>
                    <input type="text" class="form-control" id="reference" name="reference" placeholder="Optional">
                    <small class="form-text text-muted">Reference person or entity (if applicable).</small>
                  </div>
                </div>
                <!-- Reference Contact Number -->
                <div class="col-md-6">
                  <div class="mb-3">
                    <label for="reference-contact" class="form-label">Reference Contact Number</label>
                    <input type="tel" class="form-control" id="reference-contact" name="reference_contact"
                      placeholder="Optional">
                    <small class="form-text text-muted">Contact number for the reference provided.</small>
                  </div>
                </div>
              </div>

              <div class="row">
                <!-- Father's Mobile Number -->
                <div class="col-md-6">
                  <div class="mb-3">
                    <label for="father-mobile" class="form-label">Father's Mobile Number</label>
                    <input type="tel" class="form-control" id="father-mobile" name="father_mobile"
                      placeholder="Optional">
                    <small class="form-text text-muted">Mobile number of the employee's father.</small>
                  </div>
                </div>
                <!-- Mother's Mobile Number -->
                <div class="col-md-6">
                  <div class="mb-3">
                    <label for="mother-mobile" class="form-label">Mother's Mobile Number</label>
                    <input type="tel" class="form-control" id="mother-mobile" name="mother_mobile"
                      placeholder="Optional">
                    <small class="form-text text-muted">Mobile number of the employee's mother.</small>
                  </div>
                </div>
              </div>

              <div class="row">
                <!-- Spouse's Mobile Number -->
                <div class="col-md-6">
                  <div class="mb-3">
                    <label for="spouse-mobile" class="form-label">Spouse's Mobile Number</label>
                    <input type="tel" class="form-control" id="spouse-mobile" name="spouse_mobile"
                      placeholder="Optional">
                    <small class="form-text text-muted">Mobile number of the employee's spouse.</small>
                  </div>
                </div>
                <!-- Blood Group -->
                <div class="col-md-6">
                  <div class="mb-3">
                    <label for="blood-group" class="form-label">Blood Group*</label>
                    <select class="form-control" id="blood-group" name="blood_group">
                      <option value="" disabled selected>Select blood group</option>
                      <option value="A+">A+</option>
                      <option value="A-">A-</option>
                      <option value="B+">B+</option>
                      <option value="B-">B-</option>
                      <option value="AB+">AB+</option>
                      <option value="AB-">AB-</option>
                      <option value="O+">O+</option>
                      <option value="O-">O-</option>
                    </select>
                    <small class="form-text text-muted">Select the employee's blood group.</small>
                  </div>
                </div>
              </div>

              <div class="row">
                <!-- Role -->
                <div class="col-md-6">
                  <div class="mb-3">
                    <label for="role" class="form-label">Role*</label>
                    <select class="form-control" id="role" name="role">
                      <option value="" disabled selected>Select role</option>
                      <option value="admin">Admin</option>
                      <option value="moderator">Moderator</option>
                      <option value="user">User</option>
                    </select>
                    <small class="form-text text-muted">Select the employee's role within the system.</small>
                  </div>
                </div>
              </div>

              <div class="row">
                <!-- Comments -->
                <div class="col-md-12">
                  <div class="mb-3">
                    <label for="comments" class="form-label">Comments</label>
                    <textarea class="form-control" id="comments" name="comments" rows="3"
                      placeholder="Optional"></textarea>
                    <small class="form-text text-muted">Add any additional comments or information here.</small>
                  </div>
                </div>
              </div>
            </div>

            <div class="modal-footer">
              <button type="button" class="btn btn-link" data-bs-dismiss="modal">Close</button>
              <button type="submit" class="btn btn-primary">Save</button>
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>

  <!-- confirm delete model -->
  <div class="modal fade" id="confirm" tabindex="-1" aria-labelledby="confirmModalLabel" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="confirmModalLabel">Confirm Action</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          Are you sure you want to delete this item?
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
          <button type="button" class="btn btn-danger" onclick="confirmDelete()">Delete</button>
        </div>
      </div>
    </div>
  </div>


  <script>

   let deletedEmployeeID = null;

    function setEditEmployeeData(empId) {
      try {
        // Retrieve and parse data
        const rawData = $("#data").text().trim();
        let parsedData = JSON.parse(rawData);
        const { data } = parsedData;

        // Find the employee by empId
        const employee = data.find(item => item.empId === empId);

        if (!employee) {
          console.error(`Employee with ID ${empId} not found`);
          return;
        }

        console.log("Show data with ID:", empId);
        console.log("Employee data in script:", employee);

        // Create modal and form references
        const modal = new bootstrap.Modal(document.getElementById('edit-employee-model'));
        const form = document.querySelector('#edit-employee-model form');

        // Set form action URL
        const actionUrl = `/dashboard/employees/edit/${empId}`;
        form.action = actionUrl;


        // Populate form fields
        form.querySelector('#employee-name').value = employee.employeeName || '';
        form.querySelector('#dob').value = employee.dateOfBirth ? new Date(employee.dateOfBirth).toISOString().split('T')[0] : '';
        form.querySelector('#doj').value = employee.dateOfJoining ? new Date(employee.dateOfJoining).toISOString().split('T')[0] : '';
        form.querySelector('#designation').value = employee.designation || '';
        form.querySelector('#gender').value = employee.gender || '';
        form.querySelector('#email').value = employee.emailId || '';
        form.querySelector('#primary-mobile').value = employee.primaryMobileNumber || '';
        form.querySelector('#aadhar-number').value = employee.aadharNumber || '';
        form.querySelector('#pan-number').value = employee.panNumber || '';
        form.querySelector('#address').value = employee.address || '';
        form.querySelector('#bank-account').value = employee.bankAccountNumber || '';
        form.querySelector('#bank-name').value = employee.bankName || '';
        form.querySelector('#ifsc-code').value = employee.ifscCode || '';
        form.querySelector('#date-of-leaving').value = employee.dateOfLeaving ? new Date(employee.dateOfLeaving).toISOString().split('T')[0] : '';
        form.querySelector('#father-name').value = employee.fatherName || '';
        form.querySelector('#mother-name').value = employee.motherName || '';
        form.querySelector('#spouse-name').value = employee.spouseName || '';
        form.querySelector('#reference').value = employee.reference || '';
        form.querySelector('#reference-contact').value = employee.referenceContactNumber || '';
        form.querySelector('#father-mobile').value = employee.fatherMobileNumber || '';
        form.querySelector('#mother-mobile').value = employee.motherMobileNumber || '';
        form.querySelector('#spouse-mobile').value = employee.spouseMobileNumber || '';
        form.querySelector('#blood-group').value = employee.bloodGroup || '';
        form.querySelector('#role').value = employee.role || '';
        // Handle photo preview (if applicable)
        // Uncomment if you have a way to show the existing photo
        // const photoPreview = document.querySelector('#photo-preview');
        // if (employee.photo) {
        //     photoPreview.src = employee.photo; // Set this to the URL of the photo
        // } else {
        //     photoPreview.src = ''; // Hide or clear the preview
        // }

        // Show the modal
        modal.show();

      } catch (error) {
        console.error("Error handling edit data:", error);
      }
    }

    // Function to handle delete data
    function setDeleteEmployeeData(empId) {
      deletedEmployeeID=empId;
      try {
        // Retrieve and parse data
        const rawData = $("#data").text().trim();
        let parsedData = JSON.parse(rawData);
        const { data } = parsedData;

        // Find the employee by empId
        const employee = data.find(item => item.empId === empId);

        if (!employee) {
          console.error(`Employee with ID ${empId} not found`);
          return;
        }

        console.log("Show data with ID:", empId);
        console.log("Employee data in script:", employee);

        // Create modal and form references
        const modal = new bootstrap.Modal(document.getElementById('confirm'));
        // const form = document.querySelector('#edit-employee-model form');

        // // Set form action URL
        // const actionUrl = `/dashboard/employees/edit/${empId}`;
        // form.action = actionUrl;



        // Show the modal
        modal.show();

      } catch (error) {
        console.error("Error handling delete data:", error);
      }
    };
    
    async function confirmDelete() {
  // Check if the deletedEmployeeID is valid
  if (deletedEmployeeID !== null && deletedEmployeeID !== undefined) {
    try {
      const response = await fetch(`/dashboard/employees/delete/${deletedEmployeeID}`, {
        method: 'DELETE',
      });

      // Close the Bootstrap modal before alerting or refreshing the page
      const modalElement = document.getElementById('confirm');
      const modalInstance = bootstrap.Modal.getInstance(modalElement);
      modalInstance.hide();

      // const data = await response.json();

      if (response.ok) {
        alert('Record deleted successfully!');
        location.reload(); // Optionally, refresh the page to reflect changes
      } else {
        alert('Error deleting record.');
      }
    } catch (error) {
      console.error('Error:', error);
    }
  } else {
    console.error('No employee ID provided for deletion.');
  }
}

  </script>
  <%- include('../../partials/footer') %>